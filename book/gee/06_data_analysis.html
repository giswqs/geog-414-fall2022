
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>16. Analyzing Geospatial Data &#8212; Spatial Data Management with Earth Engine</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://geog-414.gishub.org/book/gee/06_data_analysis.html" />
    <link rel="shortcut icon" href="../../_static/fav.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="17. Exporting Earth Engine Data" href="07_data_export.html" />
    <link rel="prev" title="15. Visualizing Geospatial Data" href="05_data_viz.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Spatial Data Management with Earth Engine</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/instructor.html">
   Instructor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/software.html">
   Software
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/01_getting_started.html">
   1. Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/02_variables_data_types.html">
   2. Variables and Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/03_introducing_lists.html">
   3. Introducing List
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/04_working_with_lists.html">
   4. Working with Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/05_if_statements.html">
   5. Conditional Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/06_dictionaries.html">
   6. Dictionaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/07_user_input_while_loops.html">
   7. Looping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/08_functions.html">
   8. Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/09_classes.html">
   9. Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/10_files_and_exceptions.html">
   10. Files and Exceptions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Earth Engine
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_introduction.html">
   11. Introducing GEE and Geemap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_maps.html">
   12. Creating Interactive Maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_gee_data.html">
   13. Using Earth Engine Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_local_data.html">
   14. Using Local Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_data_viz.html">
   15. Visualizing Geospatial Data
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   16. Analyzing Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_data_export.html">
   17. Exporting Earth Engine Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_cartoee.html">
   18. Making Maps with Cartoee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_timelapse.html">
   19. Creating Timelapses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_webapps.html">
   20. Building Web Apps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_applications.html">
   21. Earth Engine Applications
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/README.html">
   Submission Instructions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_01.html">
   Lab 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_02.html">
   Lab 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_03.html">
   Lab 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_04.html">
   Lab 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_05.html">
   Lab 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_06.html">
   Lab 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_07.html">
   Lab 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_08.html">
   Lab 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/lab_09.html">
   Lab 9
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="issues.html">
   Known Issues
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/giswqs/geog-414/master?urlpath=tree/book/gee/06_data_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/giswqs/geog-414/blob/master/book/gee/06_data_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/giswqs/geog-414"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/giswqs/geog-414/issues/new?title=Issue%20on%20page%20%2Fbook/gee/06_data_analysis.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/giswqs/geog-414/edit/master/book/gee/06_data_analysis.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/book/gee/06_data_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../../_sources/book/gee/06_data_analysis.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   16.1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#technical-requirements">
   16.2. Technical requirements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reducer">
   16.3. Reducer
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-reductions">
     16.3.1. List reductions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imagecollection-reductions">
     16.3.2. ImageCollection reductions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-reductions">
     16.3.3. Image reductions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#featurecollection-reductions">
     16.3.4. FeatureCollection reductions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-descriptive-statistics">
   16.4. Image descriptive statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zonal-statistics">
   16.5. Zonal statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zonal-statistics-by-group">
   16.6. Zonal statistics by group
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zonal-statistics-with-two-images">
   16.7. Zonal statistics with two images
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-coordinate-grids">
   16.8. Creating coordinate grids
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-fishnets">
   16.9. Creating fishnets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sankey-diagrams">
   16.10. Sankey diagrams
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mapping-available-image-count">
   16.11. Mapping available image count
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-landsat-9">
   16.12. Using Landsat 9
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interactive-region-reduction">
   16.13. Interactive region reduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-an-interactive-map">
     16.13.1. Create an interactive map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-add-to-the-map">
     16.13.2. Add add to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-reducer">
     16.13.3. Set reducer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data">
     16.13.4. Export data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-values-to-points">
   16.14. Extracting values to points
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-pixel-values-along-a-transect">
   16.15. Extracting pixel values along a transect
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-mosaicking">
   16.16. Quality mosaicking
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     16.16.1. Create an interactive map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-a-region-of-interest-roi">
     16.16.2. Define a region of interest (ROI)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filter-imagecollection">
     16.16.3. Filter ImageCollection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-median-composite">
     16.16.4. Create a median composite
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-functions-to-add-time-bands">
     16.16.5. Define functions to add time bands
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#map-over-an-imagecollection">
     16.16.6. Map over an ImageCollection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-quality-mosaic">
     16.16.7. Create a quality mosaic
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-the-max-value-band">
     16.16.8. Display the max value band
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-time-bands">
     16.16.9. Display time bands
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interactive-charts">
   16.17. Interactive charts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chart-by-feature">
     16.17.1. Chart by feature
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chart-by-property">
     16.17.2. Chart by property
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram">
     16.17.3. Histogram
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-training-samples">
   16.18. Creating training samples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unsupervised-classification">
   16.19. Unsupervised classification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unsupervised-classification-algorithms">
     16.19.1. Unsupervised classification algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-data-to-the-map">
     16.19.2. Add data to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-image-properties">
     16.19.3. Check image properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-training-samples">
     16.19.4. Create training samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-the-clusterer">
     16.19.5. Train the clusterer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-the-image">
     16.19.6. Classify the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#label-the-clusters">
     16.19.7. Label the clusters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-results">
     16.19.8. Visualize results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-results">
     16.19.9. Export results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#supervised-classification">
   16.20. Supervised classification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#supervised-classification-algorithms">
     16.20.1. Supervised classification algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     16.20.2. Add data to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     16.20.3. Check image properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     16.20.4. Create training samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-the-classifier">
     16.20.5. Train the classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     16.20.6. Classify the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#render-categorical-map">
     16.20.7. Render categorical map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     16.20.8. Visualize results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-a-legend-to-the-map">
     16.20.9. Add a legend to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     16.20.10. Export results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-assessment">
   16.21. Accuracy assessment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     16.21.1. Supervised classification algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     16.21.2. Add data to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prepare-for-consecutive-class-labels">
     16.21.3. Prepare for consecutive class labels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-training-data">
     16.21.4. Make training data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-training-and-testing">
     16.21.5. Split training and testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     16.21.6. Train the classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     16.21.7. Classify the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     16.21.8. Render categorical map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     16.21.9. Visualize results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     16.21.10. Add a legend to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     16.21.11. Accuracy assessment
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#training-dataset">
       16.21.11.1. Training dataset
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#validation-dataset">
         16.21.11.1.1. Validation dataset
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-confusion-matrix">
     16.21.12. Download confusion matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reclassify-land-cover-map">
     16.21.13. Reclassify land cover map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     16.21.14. Export results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-locally-trained-machine-learning-models">
   16.22. Using locally trained machine learning models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-a-model-locally-using-scikit-learn">
     16.22.1. Train a model locally using scikit-learn
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-a-sklearn-classifier-object-to-a-list-of-strings">
     16.22.2. Convert a sklearn classifier object to a list of strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-sklearn-classifier-to-gee-classifier">
     16.22.3. Convert sklearn classifier to GEE classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-image-using-gee-classifier">
     16.22.4. Classify image using GEE classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-trees-to-the-cloud">
     16.22.5. Save trees to the cloud
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-trees-locally">
     16.22.6. Save trees locally
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-land-cover-area">
   16.23. Global land cover area
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#whiteboxtools">
   16.24. WhiteboxTools
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-libraries">
     16.24.1. Import libraries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-whitebox">
     16.24.2. Set up whitebox
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-sample-data">
     16.24.3. Download sample data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-las-laz-data">
     16.24.4. Read LAS/LAZ data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#upgrade-file-version">
     16.24.5. Upgrade file version
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-las-data">
     16.24.6. Write LAS data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram-analysis">
     16.24.7. Histogram analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-lidar-data">
     16.24.8. Visualize LiDAR data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-outliers">
     16.24.9. Remove outliers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-lidar-data-after-removing-outliers">
     16.24.10. Visualize LiDAR data after removing outliers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dsm">
     16.24.11. Create DSM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-dsm">
     16.24.12. Visualize DSM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dem">
     16.24.13. Create DEM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-dem">
     16.24.14. Visualize DEM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-chm">
     16.24.15. Create CHM
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   16.25. Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   16.26. References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Analyzing Geospatial Data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   16.1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#technical-requirements">
   16.2. Technical requirements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reducer">
   16.3. Reducer
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-reductions">
     16.3.1. List reductions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imagecollection-reductions">
     16.3.2. ImageCollection reductions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-reductions">
     16.3.3. Image reductions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#featurecollection-reductions">
     16.3.4. FeatureCollection reductions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-descriptive-statistics">
   16.4. Image descriptive statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zonal-statistics">
   16.5. Zonal statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zonal-statistics-by-group">
   16.6. Zonal statistics by group
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zonal-statistics-with-two-images">
   16.7. Zonal statistics with two images
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-coordinate-grids">
   16.8. Creating coordinate grids
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-fishnets">
   16.9. Creating fishnets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sankey-diagrams">
   16.10. Sankey diagrams
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mapping-available-image-count">
   16.11. Mapping available image count
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-landsat-9">
   16.12. Using Landsat 9
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interactive-region-reduction">
   16.13. Interactive region reduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-an-interactive-map">
     16.13.1. Create an interactive map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-add-to-the-map">
     16.13.2. Add add to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-reducer">
     16.13.3. Set reducer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data">
     16.13.4. Export data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-values-to-points">
   16.14. Extracting values to points
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-pixel-values-along-a-transect">
   16.15. Extracting pixel values along a transect
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-mosaicking">
   16.16. Quality mosaicking
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     16.16.1. Create an interactive map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-a-region-of-interest-roi">
     16.16.2. Define a region of interest (ROI)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filter-imagecollection">
     16.16.3. Filter ImageCollection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-median-composite">
     16.16.4. Create a median composite
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-functions-to-add-time-bands">
     16.16.5. Define functions to add time bands
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#map-over-an-imagecollection">
     16.16.6. Map over an ImageCollection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-quality-mosaic">
     16.16.7. Create a quality mosaic
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-the-max-value-band">
     16.16.8. Display the max value band
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-time-bands">
     16.16.9. Display time bands
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interactive-charts">
   16.17. Interactive charts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chart-by-feature">
     16.17.1. Chart by feature
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chart-by-property">
     16.17.2. Chart by property
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram">
     16.17.3. Histogram
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-training-samples">
   16.18. Creating training samples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unsupervised-classification">
   16.19. Unsupervised classification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unsupervised-classification-algorithms">
     16.19.1. Unsupervised classification algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-data-to-the-map">
     16.19.2. Add data to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-image-properties">
     16.19.3. Check image properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-training-samples">
     16.19.4. Create training samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-the-clusterer">
     16.19.5. Train the clusterer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-the-image">
     16.19.6. Classify the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#label-the-clusters">
     16.19.7. Label the clusters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-results">
     16.19.8. Visualize results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-results">
     16.19.9. Export results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#supervised-classification">
   16.20. Supervised classification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#supervised-classification-algorithms">
     16.20.1. Supervised classification algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     16.20.2. Add data to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     16.20.3. Check image properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     16.20.4. Create training samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-the-classifier">
     16.20.5. Train the classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     16.20.6. Classify the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#render-categorical-map">
     16.20.7. Render categorical map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     16.20.8. Visualize results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-a-legend-to-the-map">
     16.20.9. Add a legend to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     16.20.10. Export results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-assessment">
   16.21. Accuracy assessment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     16.21.1. Supervised classification algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     16.21.2. Add data to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prepare-for-consecutive-class-labels">
     16.21.3. Prepare for consecutive class labels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-training-data">
     16.21.4. Make training data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-training-and-testing">
     16.21.5. Split training and testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     16.21.6. Train the classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     16.21.7. Classify the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     16.21.8. Render categorical map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     16.21.9. Visualize results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     16.21.10. Add a legend to the map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     16.21.11. Accuracy assessment
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#training-dataset">
       16.21.11.1. Training dataset
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#validation-dataset">
         16.21.11.1.1. Validation dataset
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-confusion-matrix">
     16.21.12. Download confusion matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reclassify-land-cover-map">
     16.21.13. Reclassify land cover map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     16.21.14. Export results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-locally-trained-machine-learning-models">
   16.22. Using locally trained machine learning models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-a-model-locally-using-scikit-learn">
     16.22.1. Train a model locally using scikit-learn
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-a-sklearn-classifier-object-to-a-list-of-strings">
     16.22.2. Convert a sklearn classifier object to a list of strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-sklearn-classifier-to-gee-classifier">
     16.22.3. Convert sklearn classifier to GEE classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-image-using-gee-classifier">
     16.22.4. Classify image using GEE classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-trees-to-the-cloud">
     16.22.5. Save trees to the cloud
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-trees-locally">
     16.22.6. Save trees locally
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-land-cover-area">
   16.23. Global land cover area
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#whiteboxtools">
   16.24. WhiteboxTools
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-libraries">
     16.24.1. Import libraries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-whitebox">
     16.24.2. Set up whitebox
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-sample-data">
     16.24.3. Download sample data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-las-laz-data">
     16.24.4. Read LAS/LAZ data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#upgrade-file-version">
     16.24.5. Upgrade file version
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-las-data">
     16.24.6. Write LAS data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram-analysis">
     16.24.7. Histogram analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-lidar-data">
     16.24.8. Visualize LiDAR data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-outliers">
     16.24.9. Remove outliers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-lidar-data-after-removing-outliers">
     16.24.10. Visualize LiDAR data after removing outliers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dsm">
     16.24.11. Create DSM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-dsm">
     16.24.12. Visualize DSM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dem">
     16.24.13. Create DEM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-dem">
     16.24.14. Visualize DEM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-chm">
     16.24.15. Create CHM
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   16.25. Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   16.26. References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="analyzing-geospatial-data">
<h1><span class="section-number">16. </span>Analyzing Geospatial Data<a class="headerlink" href="#analyzing-geospatial-data" title="Permalink to this headline">#</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id17">Introduction</a></p></li>
<li><p><a class="reference internal" href="#technical-requirements" id="id18">Technical requirements</a></p></li>
<li><p><a class="reference internal" href="#reducer" id="id19">Reducer</a></p>
<ul>
<li><p><a class="reference internal" href="#list-reductions" id="id20">List reductions</a></p></li>
<li><p><a class="reference internal" href="#imagecollection-reductions" id="id21">ImageCollection reductions</a></p></li>
<li><p><a class="reference internal" href="#image-reductions" id="id22">Image reductions</a></p></li>
<li><p><a class="reference internal" href="#featurecollection-reductions" id="id23">FeatureCollection reductions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#image-descriptive-statistics" id="id24">Image descriptive statistics</a></p></li>
<li><p><a class="reference internal" href="#zonal-statistics" id="id25">Zonal statistics</a></p></li>
<li><p><a class="reference internal" href="#zonal-statistics-by-group" id="id26">Zonal statistics by group</a></p></li>
<li><p><a class="reference internal" href="#zonal-statistics-with-two-images" id="id27">Zonal statistics with two images</a></p></li>
<li><p><a class="reference internal" href="#creating-coordinate-grids" id="id28">Creating coordinate grids</a></p></li>
<li><p><a class="reference internal" href="#creating-fishnets" id="id29">Creating fishnets</a></p></li>
<li><p><a class="reference internal" href="#sankey-diagrams" id="id30">Sankey diagrams</a></p></li>
<li><p><a class="reference internal" href="#mapping-available-image-count" id="id31">Mapping available image count</a></p></li>
<li><p><a class="reference internal" href="#using-landsat-9" id="id32">Using Landsat 9</a></p></li>
<li><p><a class="reference internal" href="#interactive-region-reduction" id="id33">Interactive region reduction</a></p>
<ul>
<li><p><a class="reference internal" href="#create-an-interactive-map" id="id34">Create an interactive map</a></p></li>
<li><p><a class="reference internal" href="#add-add-to-the-map" id="id35">Add add to the map</a></p></li>
<li><p><a class="reference internal" href="#set-reducer" id="id36">Set reducer</a></p></li>
<li><p><a class="reference internal" href="#export-data" id="id37">Export data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#extracting-values-to-points" id="id38">Extracting values to points</a></p></li>
<li><p><a class="reference internal" href="#extracting-pixel-values-along-a-transect" id="id39">Extracting pixel values along a transect</a></p></li>
<li><p><a class="reference internal" href="#quality-mosaicking" id="id40">Quality mosaicking</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id41">Create an interactive map</a></p></li>
<li><p><a class="reference internal" href="#define-a-region-of-interest-roi" id="id42">Define a region of interest (ROI)</a></p></li>
<li><p><a class="reference internal" href="#filter-imagecollection" id="id43">Filter ImageCollection</a></p></li>
<li><p><a class="reference internal" href="#create-a-median-composite" id="id44">Create a median composite</a></p></li>
<li><p><a class="reference internal" href="#define-functions-to-add-time-bands" id="id45">Define functions to add time bands</a></p></li>
<li><p><a class="reference internal" href="#map-over-an-imagecollection" id="id46">Map over an ImageCollection</a></p></li>
<li><p><a class="reference internal" href="#create-a-quality-mosaic" id="id47">Create a quality mosaic</a></p></li>
<li><p><a class="reference internal" href="#display-the-max-value-band" id="id48">Display the max value band</a></p></li>
<li><p><a class="reference internal" href="#display-time-bands" id="id49">Display time bands</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#interactive-charts" id="id50">Interactive charts</a></p>
<ul>
<li><p><a class="reference internal" href="#chart-by-feature" id="id51">Chart by feature</a></p></li>
<li><p><a class="reference internal" href="#chart-by-property" id="id52">Chart by property</a></p></li>
<li><p><a class="reference internal" href="#histogram" id="id53">Histogram</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#creating-training-samples" id="id54">Creating training samples</a></p></li>
<li><p><a class="reference internal" href="#unsupervised-classification" id="id55">Unsupervised classification</a></p>
<ul>
<li><p><a class="reference internal" href="#unsupervised-classification-algorithms" id="id56">Unsupervised classification algorithms</a></p></li>
<li><p><a class="reference internal" href="#add-data-to-the-map" id="id57">Add data to the map</a></p></li>
<li><p><a class="reference internal" href="#check-image-properties" id="id58">Check image properties</a></p></li>
<li><p><a class="reference internal" href="#create-training-samples" id="id59">Create training samples</a></p></li>
<li><p><a class="reference internal" href="#train-the-clusterer" id="id60">Train the clusterer</a></p></li>
<li><p><a class="reference internal" href="#classify-the-image" id="id61">Classify the image</a></p></li>
<li><p><a class="reference internal" href="#label-the-clusters" id="id62">Label the clusters</a></p></li>
<li><p><a class="reference internal" href="#visualize-results" id="id63">Visualize results</a></p></li>
<li><p><a class="reference internal" href="#export-results" id="id64">Export results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#supervised-classification" id="id65">Supervised classification</a></p>
<ul>
<li><p><a class="reference internal" href="#supervised-classification-algorithms" id="id66">Supervised classification algorithms</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id67">Add data to the map</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id68">Check image properties</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id69">Create training samples</a></p></li>
<li><p><a class="reference internal" href="#train-the-classifier" id="id70">Train the classifier</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id71">Classify the image</a></p></li>
<li><p><a class="reference internal" href="#render-categorical-map" id="id72">Render categorical map</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id73">Visualize results</a></p></li>
<li><p><a class="reference internal" href="#add-a-legend-to-the-map" id="id74">Add a legend to the map</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id75">Export results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#accuracy-assessment" id="id76">Accuracy assessment</a></p>
<ul>
<li><p><a class="reference internal" href="#id8" id="id77">Supervised classification algorithms</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id78">Add data to the map</a></p></li>
<li><p><a class="reference internal" href="#prepare-for-consecutive-class-labels" id="id79">Prepare for consecutive class labels</a></p></li>
<li><p><a class="reference internal" href="#make-training-data" id="id80">Make training data</a></p></li>
<li><p><a class="reference internal" href="#split-training-and-testing" id="id81">Split training and testing</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id82">Train the classifier</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id83">Classify the image</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id84">Render categorical map</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id85">Visualize results</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id86">Add a legend to the map</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id87">Accuracy assessment</a></p></li>
<li><p><a class="reference internal" href="#download-confusion-matrix" id="id88">Download confusion matrix</a></p></li>
<li><p><a class="reference internal" href="#reclassify-land-cover-map" id="id89">Reclassify land cover map</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id90">Export results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-locally-trained-machine-learning-models" id="id91">Using locally trained machine learning models</a></p>
<ul>
<li><p><a class="reference internal" href="#train-a-model-locally-using-scikit-learn" id="id92">Train a model locally using scikit-learn</a></p></li>
<li><p><a class="reference internal" href="#convert-a-sklearn-classifier-object-to-a-list-of-strings" id="id93">Convert a sklearn classifier object to a list of strings</a></p></li>
<li><p><a class="reference internal" href="#convert-sklearn-classifier-to-gee-classifier" id="id94">Convert sklearn classifier to GEE classifier</a></p></li>
<li><p><a class="reference internal" href="#classify-image-using-gee-classifier" id="id95">Classify image using GEE classifier</a></p></li>
<li><p><a class="reference internal" href="#save-trees-to-the-cloud" id="id96">Save trees to the cloud</a></p></li>
<li><p><a class="reference internal" href="#save-trees-locally" id="id97">Save trees locally</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#global-land-cover-area" id="id98">Global land cover area</a></p></li>
<li><p><a class="reference internal" href="#whiteboxtools" id="id99">WhiteboxTools</a></p>
<ul>
<li><p><a class="reference internal" href="#import-libraries" id="id100">Import libraries</a></p></li>
<li><p><a class="reference internal" href="#set-up-whitebox" id="id101">Set up whitebox</a></p></li>
<li><p><a class="reference internal" href="#download-sample-data" id="id102">Download sample data</a></p></li>
<li><p><a class="reference internal" href="#read-las-laz-data" id="id103">Read LAS/LAZ data</a></p></li>
<li><p><a class="reference internal" href="#upgrade-file-version" id="id104">Upgrade file version</a></p></li>
<li><p><a class="reference internal" href="#write-las-data" id="id105">Write LAS data</a></p></li>
<li><p><a class="reference internal" href="#histogram-analysis" id="id106">Histogram analysis</a></p></li>
<li><p><a class="reference internal" href="#visualize-lidar-data" id="id107">Visualize LiDAR data</a></p></li>
<li><p><a class="reference internal" href="#remove-outliers" id="id108">Remove outliers</a></p></li>
<li><p><a class="reference internal" href="#visualize-lidar-data-after-removing-outliers" id="id109">Visualize LiDAR data after removing outliers</a></p></li>
<li><p><a class="reference internal" href="#create-dsm" id="id110">Create DSM</a></p></li>
<li><p><a class="reference internal" href="#visualize-dsm" id="id111">Visualize DSM</a></p></li>
<li><p><a class="reference internal" href="#create-dem" id="id112">Create DEM</a></p></li>
<li><p><a class="reference internal" href="#visualize-dem" id="id113">Visualize DEM</a></p></li>
<li><p><a class="reference internal" href="#create-chm" id="id114">Create CHM</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary" id="id115">Summary</a></p></li>
<li><p><a class="reference internal" href="#references" id="id116">References</a></p></li>
</ul>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#id17"><span class="section-number">16.1. </span>Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
</section>
<section id="technical-requirements">
<h2><a class="toc-backref" href="#id18"><span class="section-number">16.2. </span>Technical requirements</a><a class="headerlink" href="#technical-requirements" title="Permalink to this headline">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create -n gee python
conda activate gee
conda install -c conda-forge mamba
mamba install -c conda-forge geemap pygis
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter lab
</pre></div>
</div>
<p><a class="reference external" href="https://colab.research.google.com/github/giswqs/geebook/blob/master/chapters/06_data_analysis.ipynb"><img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pip install pygis</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ee</span>
<span class="kn">import</span> <span class="nn">geemap</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_initialize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reducer">
<h2><a class="toc-backref" href="#id19"><span class="section-number">16.3. </span>Reducer</a><a class="headerlink" href="#reducer" title="Permalink to this headline">#</a></h2>
<section id="list-reductions">
<h3><a class="toc-backref" href="#id20"><span class="section-number">16.3.1. </span>List reductions</a><a class="headerlink" href="#list-reductions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">min_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_max_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">minMax</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">min_max_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 5.5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">median_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">median_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 5.5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sum_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sum_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 55</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">std_value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">stdDev</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">std_value</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 2.8723</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="imagecollection-reductions">
<h3><a class="toc-backref" href="#id21"><span class="section-number">16.3.2. </span>ImageCollection reductions</a><a class="headerlink" href="#imagecollection-reductions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="c1"># Load an image collection, filtered so it&#39;s not too much data.</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_TOA&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;WRS_PATH&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;WRS_ROW&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Compute the median in each band, each pixel.</span>
<span class="c1"># Band names are B1_median, B2_median, etc.</span>
<span class="n">median</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

<span class="c1"># The output is an Image.  Add it to the map.</span>
<span class="n">vis_param</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B5_median&#39;</span><span class="p">,</span> <span class="s1">&#39;B4_median&#39;</span><span class="p">,</span> <span class="s1">&#39;B3_median&#39;</span><span class="p">],</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">setCenter</span><span class="p">(</span><span class="o">-</span><span class="mf">122.3355</span><span class="p">,</span> <span class="mf">37.7924</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">vis_param</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">median</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="image-reductions">
<h3><a class="toc-backref" href="#id22"><span class="section-number">16.3.3. </span>Image reductions</a><a class="headerlink" href="#image-reductions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="c1"># Load an image and select some bands of interest.</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1/LC08_044034_20140318&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">])</span>

<span class="c1"># Reduce the image to get a one-band maximum value image.</span>
<span class="n">maxValue</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Display the result.</span>
<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Original image&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">maxValue</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">13000</span><span class="p">},</span> <span class="s1">&#39;Maximum value image&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="featurecollection-reductions">
<h3><a class="toc-backref" href="#id23"><span class="section-number">16.3.4. </span>FeatureCollection reductions</a><a class="headerlink" href="#featurecollection-reductions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="c1"># Load US census data as a FeatureCollection.</span>
<span class="n">census</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;TIGER/2010/Blocks&#39;</span><span class="p">)</span>

<span class="c1"># Filter the collection to include only Benton County, OR.</span>
<span class="n">benton</span> <span class="o">=</span> <span class="n">census</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;statefp10&#39;</span><span class="p">,</span> <span class="s1">&#39;41&#39;</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;countyfp10&#39;</span><span class="p">,</span> <span class="s1">&#39;003&#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Display Benton County census blocks.</span>
<span class="n">Map</span><span class="o">.</span><span class="n">setCenter</span><span class="p">(</span><span class="o">-</span><span class="mf">123.27</span><span class="p">,</span> <span class="mf">44.57</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">benton</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute sums of the specified properties.</span>
<span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pop10&#39;</span><span class="p">,</span> <span class="s1">&#39;housing10&#39;</span><span class="p">]</span>
<span class="n">sums</span> <span class="o">=</span> <span class="n">benton</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">notNull</span><span class="p">(</span><span class="n">properties</span><span class="p">))</span><span class="o">.</span><span class="n">reduceColumns</span><span class="p">(</span>
    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;reducer&#39;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;selectors&#39;</span><span class="p">:</span> <span class="n">properties</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Print the resultant Dictionary.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sums</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">benton</span><span class="o">.</span><span class="n">aggregate_sum</span><span class="p">(</span><span class="s1">&#39;pop10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 85579</span>
<span class="nb">print</span><span class="p">(</span><span class="n">benton</span><span class="o">.</span><span class="n">aggregate_sum</span><span class="p">(</span><span class="s1">&#39;housing10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>  <span class="c1"># 36245</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">benton</span><span class="o">.</span><span class="n">aggregate_stats</span><span class="p">(</span><span class="s1">&#39;pop10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="image-descriptive-statistics">
<h2><a class="toc-backref" href="#id24"><span class="section-number">16.4. </span>Image descriptive statistics</a><a class="headerlink" href="#image-descriptive-statistics" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="n">centroid</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="o">-</span><span class="mf">122.4439</span><span class="p">,</span> <span class="mf">37.7538</span><span class="p">])</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">centroid</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">vis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]}</span>

<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">centroid</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">vis</span><span class="p">,</span> <span class="s2">&quot;Landsat-8&quot;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>  <span class="c1"># 0.05</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_props</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">props</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_stats</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="zonal-statistics">
<h2><a class="toc-backref" href="#id25"><span class="section-number">16.5. </span>Zonal statistics</a><a class="headerlink" href="#zonal-statistics" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Add NASA SRTM</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/SRTMGL1_003&#39;</span><span class="p">)</span>
<span class="n">dem_vis</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;006633&#39;</span><span class="p">,</span> <span class="s1">&#39;E5FFCC&#39;</span><span class="p">,</span> <span class="s1">&#39;662A00&#39;</span><span class="p">,</span> <span class="s1">&#39;D8D8D8&#39;</span><span class="p">,</span> <span class="s1">&#39;F5F5F5&#39;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">dem_vis</span><span class="p">,</span> <span class="s1">&#39;SRTM DEM&#39;</span><span class="p">)</span>

<span class="c1"># Add 5-year Landsat TOA composite</span>
<span class="n">landsat</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LE7_TOA_5YEAR/1999_2003&#39;</span><span class="p">)</span>
<span class="n">landsat_vis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">],</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landsat</span><span class="p">,</span> <span class="n">landsat_vis</span><span class="p">,</span> <span class="s2">&quot;Landsat&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add US Census States</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;TIGER/2018/States&quot;</span><span class="p">)</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fillColor&#39;</span><span class="p">:</span> <span class="s1">&#39;00000000&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">),</span> <span class="p">{},</span> <span class="s1">&#39;US States&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">out_dem_stats</span> <span class="o">=</span> <span class="s1">&#39;dem_stats.csv&#39;</span>
<span class="n">geemap</span><span class="o">.</span><span class="n">zonal_stats</span><span class="p">(</span>
    <span class="n">dem</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">out_dem_stats</span><span class="p">,</span> <span class="n">statistics_type</span><span class="o">=</span><span class="s1">&#39;MEAN&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">return_fc</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">out_landsat_stats</span> <span class="o">=</span> <span class="s1">&#39;landsat_stats.csv&#39;</span>
<span class="n">geemap</span><span class="o">.</span><span class="n">zonal_stats</span><span class="p">(</span>
    <span class="n">landsat</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">out_landsat_stats</span><span class="p">,</span>
    <span class="n">statistics_type</span><span class="o">=</span><span class="s1">&#39;MEAN&#39;</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">return_fc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="zonal-statistics-by-group">
<h2><a class="toc-backref" href="#id26"><span class="section-number">16.6. </span>Zonal statistics by group</a><a class="headerlink" href="#zonal-statistics-by-group" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Add NLCD data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/NLCD_RELEASES/2019_REL/NLCD/2019&#39;</span><span class="p">)</span>
<span class="n">landcover</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;landcover&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD 2019&#39;</span><span class="p">)</span>

<span class="c1"># Add US census states</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;TIGER/2018/States&quot;</span><span class="p">)</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fillColor&#39;</span><span class="p">:</span> <span class="s1">&#39;00000000&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">),</span> <span class="p">{},</span> <span class="s1">&#39;US States&#39;</span><span class="p">)</span>

<span class="c1"># Add NLCD legend</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;NLCD Land Cover&#39;</span><span class="p">,</span> <span class="n">builtin_legend</span><span class="o">=</span><span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_stats</span> <span class="o">=</span> <span class="s1">&#39;nlcd_stats.csv&#39;</span>

<span class="n">geemap</span><span class="o">.</span><span class="n">zonal_stats_by_group</span><span class="p">(</span>
    <span class="n">landcover</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">nlcd_stats</span><span class="p">,</span>
    <span class="n">statistics_type</span><span class="o">=</span><span class="s1">&#39;SUM&#39;</span><span class="p">,</span>
    <span class="n">denominator</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span>
    <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_stats</span> <span class="o">=</span> <span class="s1">&#39;nlcd_stats_pct.csv&#39;</span>

<span class="n">geemap</span><span class="o">.</span><span class="n">zonal_stats_by_group</span><span class="p">(</span>
    <span class="n">landcover</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">nlcd_stats</span><span class="p">,</span>
    <span class="n">statistics_type</span><span class="o">=</span><span class="s1">&#39;PERCENTAGE&#39;</span><span class="p">,</span>
    <span class="n">denominator</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span>
    <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="zonal-statistics-with-two-images">
<h2><a class="toc-backref" href="#id27"><span class="section-number">16.7. </span>Zonal statistics with two images</a><a class="headerlink" href="#zonal-statistics-with-two-images" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/3DEP/10m&#39;</span><span class="p">)</span>
<span class="n">vis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;terrain&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">vis</span><span class="p">,</span> <span class="s1">&#39;DEM&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landcover</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;USGS/NLCD_RELEASES/2019_REL/NLCD/2019&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;landcover&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD 2019&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;NLCD Land Cover Classification&#39;</span><span class="p">,</span> <span class="n">builtin_legend</span><span class="o">=</span><span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_stats_by_zone</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">landcover</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;MEAN&#39;</span><span class="p">)</span>
<span class="n">stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mean.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">image_stats_by_zone</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">landcover</span><span class="p">,</span> <span class="n">out_csv</span><span class="o">=</span><span class="s2">&quot;std.csv&quot;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;STD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-coordinate-grids">
<h2><a class="toc-backref" href="#id28"><span class="section-number">16.8. </span>Creating coordinate grids</a><a class="headerlink" href="#creating-coordinate-grids" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lat_grid</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">latitude_grid</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">west</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">east</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">south</span><span class="o">=-</span><span class="mi">85</span><span class="p">,</span> <span class="n">north</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fillColor&#39;</span><span class="p">:</span> <span class="s1">&#39;00000000&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">lat_grid</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">),</span> <span class="p">{},</span> <span class="s1">&#39;Latitude Grid&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">ee_to_df</span><span class="p">(</span><span class="n">lat_grid</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lon_grid</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">longitude_grid</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">west</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">east</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">south</span><span class="o">=-</span><span class="mi">85</span><span class="p">,</span> <span class="n">north</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fillColor&#39;</span><span class="p">:</span> <span class="s1">&#39;00000000&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">lon_grid</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">),</span> <span class="p">{},</span> <span class="s1">&#39;Longitude Grid&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">latlon_grid</span><span class="p">(</span>
    <span class="n">lat_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lon_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">west</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">east</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">south</span><span class="o">=-</span><span class="mi">85</span><span class="p">,</span> <span class="n">north</span><span class="o">=</span><span class="mi">85</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fillColor&#39;</span><span class="p">:</span> <span class="s1">&#39;00000000&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">),</span> <span class="p">{},</span> <span class="s1">&#39;Coordinate Grid&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-fishnets">
<h2><a class="toc-backref" href="#id29"><span class="section-number">16.9. </span>Creating fishnets</a><a class="headerlink" href="#creating-fishnets" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">user_roi</span>

<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">BBox</span><span class="p">(</span><span class="o">-</span><span class="mf">112.8089</span><span class="p">,</span> <span class="mf">33.7306</span><span class="p">,</span> <span class="o">-</span><span class="mf">88.5951</span><span class="p">,</span> <span class="mf">46.6244</span><span class="p">)</span>
    <span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;ROI&#39;</span><span class="p">)</span>
    <span class="n">Map</span><span class="o">.</span><span class="n">user_roi</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fishnet</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">fishnet</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">h_interval</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">v_interval</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">fishnet</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Fishnet 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">user_roi</span>

<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">64.602356</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.127399</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">68.821106</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.625598</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">60.647278</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.498601</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">47.815247</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.111406</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">43.860168</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.913564</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">54.582825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.775886</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">60.823059</span><span class="p">,</span> <span class="mf">0.454555</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">64.602356</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.127399</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;ROI2&#39;</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fishnet</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">fishnet</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">fishnet</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Fishnet 2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sankey-diagrams">
<h2><a class="toc-backref" href="#id30"><span class="section-number">16.10. </span>Sankey diagrams</a><a class="headerlink" href="#sankey-diagrams" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sankee</span>

<span class="n">sankee</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">LCMS_LC</span><span class="o">.</span><span class="n">sankify</span><span class="p">(</span>
    <span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2020</span><span class="p">],</span>
    <span class="n">region</span><span class="o">=</span><span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="o">-</span><span class="mf">122.192688</span><span class="p">,</span> <span class="mf">46.25917</span><span class="p">])</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">2000</span><span class="p">),</span>
    <span class="n">max_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mount St. Helens Recovery&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">650</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mapping-available-image-count">
<h2><a class="toc-backref" href="#id31"><span class="section-number">16.11. </span>Mapping available image count</a><a class="headerlink" href="#mapping-available-image-count" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C02/T1_L2&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_count</span><span class="p">(</span>
    <span class="n">collection</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">vis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">vis</span><span class="p">,</span> <span class="s1">&#39;Image Count&#39;</span><span class="p">)</span>

<span class="n">countries</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">geemap</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">get_ee_path</span><span class="p">(</span><span class="s1">&#39;countries&#39;</span><span class="p">))</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;00000088&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillColor&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000&quot;</span><span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">countries</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">),</span> <span class="p">{},</span> <span class="s2">&quot;Countries&quot;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Landsat 8 Image Count&#39;</span><span class="p">)</span>

<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-landsat-9">
<h2><a class="toc-backref" href="#id32"><span class="section-number">16.12. </span>Using Landsat 9</a><a class="headerlink" href="#using-landsat-9" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC09/C02/T1_L2&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_scale_factors</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">opticalBands</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;SR_B.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.0000275</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">thermalBands</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;ST_B.*&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.00341802</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">149.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">opticalBands</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">thermalBands</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">apply_scale_factors</span><span class="p">(</span><span class="n">median</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vis_natural</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SR_B4&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B3&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">vis_nir</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SR_B5&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B4&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B3&#39;</span><span class="p">],</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">vis_natural</span><span class="p">,</span> <span class="s1">&#39;True color (432)&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">vis_nir</span><span class="p">,</span> <span class="s1">&#39;Color infrared (543)&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/USPMXzw.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vis_params</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SR_B4&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B3&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B2&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SR_B5&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B4&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B3&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SR_B7&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B6&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B4&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SR_B6&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B5&#39;</span><span class="p">,</span> <span class="s1">&#39;SR_B2&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Natural Color (4, 3, 2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Color Infrared (5, 4, 3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Short-Wave Infrared (7, 6 4)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Agriculture (6, 5, 2)&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">linked_maps</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="s2">&quot;300px&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ee_objects</span><span class="o">=</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="n">vis_params</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">label_position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/c4FsGBI.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landsat8</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C02/T1_L2/LC08_015043_20130402&#39;</span><span class="p">)</span>
<span class="n">landsat9</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC09/C02/T1_L2/LC09_015043_20211231&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landsat8</span> <span class="o">=</span> <span class="n">apply_scale_factors</span><span class="p">(</span><span class="n">landsat8</span><span class="p">)</span>
<span class="n">landsat9</span> <span class="o">=</span> <span class="n">apply_scale_factors</span><span class="p">(</span><span class="n">landsat9</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">left_layer</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">ee_tile_layer</span><span class="p">(</span><span class="n">landsat8</span><span class="p">,</span> <span class="n">vis_natural</span><span class="p">,</span> <span class="s1">&#39;Landsat 8&#39;</span><span class="p">)</span>
<span class="n">right_layer</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">ee_tile_layer</span><span class="p">(</span><span class="n">landsat9</span><span class="p">,</span> <span class="n">vis_nir</span><span class="p">,</span> <span class="s1">&#39;Landsat 9&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span><span class="o">.</span><span class="n">split_map</span><span class="p">(</span><span class="n">left_layer</span><span class="p">,</span> <span class="n">right_layer</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">landsat9</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/i6lUYHF.jpg" /></p>
</section>
<section id="interactive-region-reduction">
<h2><a class="toc-backref" href="#id33"><span class="section-number">16.13. </span>Interactive region reduction</a><a class="headerlink" href="#interactive-region-reduction" title="Permalink to this headline">#</a></h2>
<section id="create-an-interactive-map">
<h3><a class="toc-backref" href="#id34"><span class="section-number">16.13.1. </span>Create an interactive map</a><a class="headerlink" href="#create-an-interactive-map" title="Permalink to this headline">#</a></h3>
</section>
<section id="add-add-to-the-map">
<h3><a class="toc-backref" href="#id35"><span class="section-number">16.13.2. </span>Add add to the map</a><a class="headerlink" href="#add-add-to-the-map" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="n">collection</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;MODIS/006/MOD13A2&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-31&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Convert the image collection to an image.</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">toBands</span><span class="p">()</span>

<span class="n">ndvi_vis</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">9000.0</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;ndvi&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;MODIS NDVI Time-series&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">ndvi_vis</span><span class="p">,</span> <span class="s1">&#39;First image&#39;</span><span class="p">)</span>

<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-reducer">
<h3><a class="toc-backref" href="#id36"><span class="section-number">16.13.3. </span>Set reducer</a><a class="headerlink" href="#set-reducer" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">set_plot_options</span><span class="p">(</span><span class="n">add_marker_cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">roi_reducer</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="export-data">
<h3><a class="toc-backref" href="#id37"><span class="section-number">16.13.4. </span>Export data</a><a class="headerlink" href="#export-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">extract_values_to_points</span><span class="p">(</span><span class="s1">&#39;ndvi.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="extracting-values-to-points">
<h2><a class="toc-backref" href="#id38"><span class="section-number">16.14. </span>Extracting values to points</a><a class="headerlink" href="#extracting-values-to-points" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="c1"># Add Earth Engine dataset</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/SRTMGL1_003&#39;</span><span class="p">)</span>
<span class="n">landsat7</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LE7_TOA_5YEAR/1999_2003&#39;</span><span class="p">)</span>

<span class="c1"># Set visualization parameters.</span>
<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;006633&#39;</span><span class="p">,</span> <span class="s1">&#39;E5FFCC&#39;</span><span class="p">,</span> <span class="s1">&#39;662A00&#39;</span><span class="p">,</span> <span class="s1">&#39;D8D8D8&#39;</span><span class="p">,</span> <span class="s1">&#39;F5F5F5&#39;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Add Earth Engine layers to Map</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">landsat7</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="s1">&#39;Landsat 7&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s1">&#39;SRTM DEM&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">in_shp</span> <span class="o">=</span> <span class="s1">&#39;us_cities.shp&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_shp</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/giswqs/data/raw/main/us/us_cities.zip&#39;</span>
    <span class="n">geemap</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">in_fc</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">shp_to_ee</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">in_fc</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Cities&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">extract_values_to_points</span><span class="p">(</span><span class="n">in_fc</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="s2">&quot;dem.shp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">extract_values_to_points</span><span class="p">(</span><span class="n">in_fc</span><span class="p">,</span> <span class="n">landsat7</span><span class="p">,</span> <span class="s1">&#39;landsat.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="extracting-pixel-values-along-a-transect">
<h2><a class="toc-backref" href="#id39"><span class="section-number">16.15. </span>Extracting pixel values along a transect</a><a class="headerlink" href="#extracting-pixel-values-along-a-transect" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;TERRAIN&quot;</span><span class="p">)</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/SRTMGL1_003&#39;</span><span class="p">)</span>
<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;006633&#39;</span><span class="p">,</span> <span class="s1">&#39;E5FFCC&#39;</span><span class="p">,</span> <span class="s1">&#39;662A00&#39;</span><span class="p">,</span> <span class="s1">&#39;D8D8D8&#39;</span><span class="p">,</span> <span class="s1">&#39;F5F5F5&#39;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s1">&#39;SRTM DEM&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the drawing tool to draw any line on the map.</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">user_roi</span>
<span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
        <span class="p">[[</span><span class="o">-</span><span class="mf">120.2232</span><span class="p">,</span> <span class="mf">36.3148</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">118.9269</span><span class="p">,</span> <span class="mf">36.7121</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">117.2022</span><span class="p">,</span> <span class="mf">36.7562</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;ROI&quot;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reducer</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span>  <span class="c1"># Any ee.Reducer, e.g., mean, median, min, max, stdDev</span>
<span class="n">transect</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">extract_transect</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">n_segments</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">,</span> <span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">transect</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transect</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;transect.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bqplot</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">transect</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">],</span> <span class="n">transect</span><span class="p">[</span><span class="n">reducer</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Elevation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="quality-mosaicking">
<h2><a class="toc-backref" href="#id40"><span class="section-number">16.16. </span>Quality mosaicking</a><a class="headerlink" href="#quality-mosaicking" title="Permalink to this headline">#</a></h2>
<section id="id1">
<h3><a class="toc-backref" href="#id41"><span class="section-number">16.16.1. </span>Create an interactive map</a><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-a-region-of-interest-roi">
<h3><a class="toc-backref" href="#id42"><span class="section-number">16.16.2. </span>Define a region of interest (ROI)</a><a class="headerlink" href="#define-a-region-of-interest-roi" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">countries</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">geemap</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">get_ee_path</span><span class="p">(</span><span class="s1">&#39;countries&#39;</span><span class="p">))</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;coutries&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roi</span> <span class="o">=</span> <span class="n">countries</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;ISO_A3&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">))</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;roi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="filter-imagecollection">
<h3><a class="toc-backref" href="#id43"><span class="section-number">16.16.3. </span>Filter ImageCollection</a><a class="headerlink" href="#filter-imagecollection" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2019-01-01&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;2019-12-31&#39;</span>

<span class="n">l8</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_TOA&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-median-composite">
<h3><a class="toc-backref" href="#id44"><span class="section-number">16.16.4. </span>Create a median composite</a><a class="headerlink" href="#create-a-median-composite" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">l8</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">visParams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">visParams</span><span class="p">,</span> <span class="s1">&#39;Median&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-functions-to-add-time-bands">
<h3><a class="toc-backref" href="#id45"><span class="section-number">16.16.5. </span>Define functions to add time bands</a><a class="headerlink" href="#define-functions-to-add-time-bands" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">addNDVI</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">ndvi</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">ndvi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">addDate</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">img_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
    <span class="n">img_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">img_date</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;YYYYMMdd&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img_date</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">addMonth</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">img_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
    <span class="n">img_doy</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">img_date</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img_doy</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">addDOY</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">img_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
    <span class="n">img_doy</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">img_date</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img_doy</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;doy&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="map-over-an-imagecollection">
<h3><a class="toc-backref" href="#id46"><span class="section-number">16.16.6. </span>Map over an ImageCollection</a><a class="headerlink" href="#map-over-an-imagecollection" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">withNDVI</span> <span class="o">=</span> <span class="n">l8</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">addNDVI</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">addDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">addMonth</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">addDOY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-quality-mosaic">
<h3><a class="toc-backref" href="#id47"><span class="section-number">16.16.7. </span>Create a quality mosaic</a><a class="headerlink" href="#create-a-quality-mosaic" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">greenest</span> <span class="o">=</span> <span class="n">withNDVI</span><span class="o">.</span><span class="n">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">greenest</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="display-the-max-value-band">
<h3><a class="toc-backref" href="#id48"><span class="section-number">16.16.8. </span>Display the max value band</a><a class="headerlink" href="#display-the-max-value-band" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ndvi</span> <span class="o">=</span> <span class="n">greenest</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="n">palette</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;#d73027&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#f46d43&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#fdae61&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#fee08b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#d9ef8b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#a6d96a&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#66bd63&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#1a9850&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">ndvi</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">palette</span><span class="p">},</span> <span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">greenest</span><span class="p">,</span> <span class="n">visParams</span><span class="p">,</span> <span class="s1">&#39;Greenest pixel&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="display-time-bands">
<h3><a class="toc-backref" href="#id49"><span class="section-number">16.16.9. </span>Display time bands</a><a class="headerlink" href="#display-time-bands" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">greenest</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">),</span>
    <span class="p">{</span><span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
    <span class="s1">&#39;Greenest month&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">greenest</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;doy&#39;</span><span class="p">),</span>
    <span class="p">{</span><span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">},</span>
    <span class="s1">&#39;Greenest doy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="interactive-charts">
<h2><a class="toc-backref" href="#id50"><span class="section-number">16.17. </span>Interactive charts</a><a class="headerlink" href="#interactive-charts" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geemap.chart</span> <span class="k">as</span> <span class="nn">chart</span>
</pre></div>
</div>
</div>
</div>
<section id="chart-by-feature">
<h3><a class="toc-backref" href="#id51"><span class="section-number">16.17.1. </span>Chart by feature</a><a class="headerlink" href="#chart-by-feature" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;projects/google/charts_feature_example&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="s1">&#39;[0-9][0-9]_tmean|label&#39;</span>
<span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;Ecoregions&quot;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">ee_to_pandas</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xProperty</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span>
<span class="n">yProperties</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_tmean&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Jan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Feb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Apr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;May&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Jun&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Jul&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Aug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sep&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Oct&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Nov&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dec&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;#604791&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#1d6b99&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#39a8a7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#0f8755&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#76b349&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#f0af07&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#e37d05&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#cf513e&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#96356f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#724173&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#9c4f97&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#696969&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Average Monthly Temperature by Ecoregion&quot;</span>
<span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Ecoregion&quot;</span>
<span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Temperature&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
    <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="n">colors</span><span class="p">,</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
    <span class="s2">&quot;xlabel&quot;</span><span class="p">:</span> <span class="n">xlabel</span><span class="p">,</span>
    <span class="s2">&quot;ylabel&quot;</span><span class="p">:</span> <span class="n">ylabel</span><span class="p">,</span>
    <span class="s2">&quot;legend_location&quot;</span><span class="p">:</span> <span class="s2">&quot;top-left&quot;</span><span class="p">,</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;500px&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_byFeature</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">xProperty</span><span class="p">,</span> <span class="n">yProperties</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/9xzsUxg.jpg" /></p>
</section>
<section id="chart-by-property">
<h3><a class="toc-backref" href="#id52"><span class="section-number">16.17.2. </span>Chart by property</a><a class="headerlink" href="#chart-by-property" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="n">features</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;projects/google/charts_feature_example&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="s1">&#39;[0-9][0-9]_ppt|label&#39;</span>
<span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Features&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">ee_to_pandas</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_ppt&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Jan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Feb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Apr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;May&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Jun&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Jul&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Aug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sep&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Oct&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Nov&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dec&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xProperties</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
<span class="n">seriesProperty</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Average Ecoregion Precipitation by Month&quot;</span><span class="p">,</span>
    <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#f0af07&#39;</span><span class="p">,</span> <span class="s1">&#39;#0f8755&#39;</span><span class="p">,</span> <span class="s1">&#39;#76b349&#39;</span><span class="p">],</span>
    <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s2">&quot;Month&quot;</span><span class="p">,</span>
    <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s2">&quot;Precipitation (mm)&quot;</span><span class="p">,</span>
    <span class="s1">&#39;legend_location&#39;</span><span class="p">:</span> <span class="s2">&quot;top-left&quot;</span><span class="p">,</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;500px&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_byProperty</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">xProperties</span><span class="p">,</span> <span class="n">seriesProperty</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/mS3vzHJ.jpg" /></p>
</section>
<section id="histogram">
<h3><a class="toc-backref" href="#id53"><span class="section-number">16.17.3. </span>Histogram</a><a class="headerlink" href="#histogram" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geemap.chart</span> <span class="k">as</span> <span class="nn">chart</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;OREGONSTATE/PRISM/Norm81m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">toBands</span><span class="p">()</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="o">-</span><span class="mf">123.41</span><span class="p">,</span> <span class="mf">40.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">116.38</span><span class="p">,</span> <span class="mf">45.14</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">prop</span> <span class="o">=</span> <span class="s1">&#39;07_ppt&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s1">&#39;July Precipitation Distribution for NW USA&#39;</span><span class="p">,</span>
    <span class="s2">&quot;xlabel&quot;</span><span class="p">:</span> <span class="s1">&#39;Precipitation (mm)&#39;</span><span class="p">,</span>
    <span class="s2">&quot;ylabel&quot;</span><span class="p">:</span> <span class="s1">&#39;Pixel count&#39;</span><span class="p">,</span>
    <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#1d6b99&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_histogram</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/zgzpfvb.gif" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_histogram</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">maxBuckets</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/WV7aB1e.gif" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_histogram</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">minBucketWidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_histogram</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">minBucketWidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">maxBuckets</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="creating-training-samples">
<h2><a class="toc-backref" href="#id54"><span class="section-number">16.18. </span>Creating training samples</a><a class="headerlink" href="#creating-training-samples" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Map</span><span class="o">.</span><span class="n">user_rois</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">training_samples</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">user_rois</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">training_samples</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unsupervised-classification">
<h2><a class="toc-backref" href="#id55"><span class="section-number">16.19. </span>Unsupervised classification</a><a class="headerlink" href="#unsupervised-classification" title="Permalink to this headline">#</a></h2>
<section id="unsupervised-classification-algorithms">
<h3><a class="toc-backref" href="#id56"><span class="section-number">16.19.1. </span>Unsupervised classification algorithms</a><a class="headerlink" href="#unsupervised-classification-algorithms" title="Permalink to this headline">#</a></h3>
<p><img alt="" src="https://i.imgur.com/IcBapEx.jpg" /></p>
</section>
<section id="add-data-to-the-map">
<h3><a class="toc-backref" href="#id57"><span class="section-number">16.19.2. </span>Add data to the map</a><a class="headerlink" href="#add-data-to-the-map" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="c1"># point = ee.Geometry.Point([-122.4439, 37.7538])</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="o">-</span><span class="mf">87.7719</span><span class="p">,</span> <span class="mf">41.8799</span><span class="p">])</span>

<span class="n">image</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-31&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;B[1-7]&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]}</span>

<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s2">&quot;Landsat-8&quot;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-image-properties">
<h3><a class="toc-backref" href="#id58"><span class="section-number">16.19.3. </span>Check image properties</a><a class="headerlink" href="#check-image-properties" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_props</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">props</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IMAGE_DATE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-training-samples">
<h3><a class="toc-backref" href="#id59"><span class="section-number">16.19.4. </span>Create training samples</a><a class="headerlink" href="#create-training-samples" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># region = Map.user_roi</span>
<span class="c1"># region = ee.Geometry.Rectangle([-122.6003, 37.4831, -121.8036, 37.8288])</span>
<span class="c1"># region = ee.Geometry.Point([-122.4439, 37.7538]).buffer(10000)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the training dataset.</span>
<span class="n">training</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="o">**</span><span class="p">{</span>
        <span class="c1">#     &#39;region&#39;: region,</span>
        <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s1">&#39;numPixels&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;geometries&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Set this to False to ignore geometries</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">training</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="train-the-clusterer">
<h3><a class="toc-backref" href="#id60"><span class="section-number">16.19.5. </span>Train the clusterer</a><a class="headerlink" href="#train-the-clusterer" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate the clusterer and train it.</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">clusterer</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Clusterer</span><span class="o">.</span><span class="n">wekaKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="classify-the-image">
<h3><a class="toc-backref" href="#id61"><span class="section-number">16.19.6. </span>Classify the image</a><a class="headerlink" href="#classify-the-image" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cluster the input using the trained clusterer.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">clusterer</span><span class="p">)</span>

<span class="c1"># # Display the clusters with random colors.</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">randomVisualizer</span><span class="p">(),</span> <span class="p">{},</span> <span class="s1">&#39;clusters&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="label-the-clusters">
<h3><a class="toc-backref" href="#id62"><span class="section-number">16.19.7. </span>Label the clusters</a><a class="headerlink" href="#label-the-clusters" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">legend_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;One&#39;</span><span class="p">,</span> <span class="s1">&#39;Two&#39;</span><span class="p">,</span> <span class="s1">&#39;Three&#39;</span><span class="p">,</span> <span class="s1">&#39;Four&#39;</span><span class="p">,</span> <span class="s1">&#39;ect&#39;</span><span class="p">]</span>
<span class="n">legend_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#8DD3C7&#39;</span><span class="p">,</span> <span class="s1">&#39;#FFFFB3&#39;</span><span class="p">,</span> <span class="s1">&#39;#BEBADA&#39;</span><span class="p">,</span> <span class="s1">&#39;#FB8072&#39;</span><span class="p">,</span> <span class="s1">&#39;#80B1D3&#39;</span><span class="p">]</span>

<span class="c1"># Reclassify the map</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">remap</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">result</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">legend_colors</span><span class="p">},</span> <span class="s1">&#39;Labelled clusters&#39;</span>
<span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
    <span class="n">legend_keys</span><span class="o">=</span><span class="n">legend_keys</span><span class="p">,</span> <span class="n">legend_colors</span><span class="o">=</span><span class="n">legend_colors</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span>
<span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-results">
<h3><a class="toc-backref" href="#id63"><span class="section-number">16.19.8. </span>Visualize results</a><a class="headerlink" href="#visualize-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Change layer opacity:&#39;</span><span class="p">)</span>
<span class="n">cluster_layer</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cluster_layer</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="export-results">
<h3><a class="toc-backref" href="#id64"><span class="section-number">16.19.9. </span>Export results</a><a class="headerlink" href="#export-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_export_image</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;cluster.tif&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_export_image_to_drive</span><span class="p">(</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;clusters&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">90</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="supervised-classification">
<h2><a class="toc-backref" href="#id65"><span class="section-number">16.20. </span>Supervised classification</a><a class="headerlink" href="#supervised-classification" title="Permalink to this headline">#</a></h2>
<section id="supervised-classification-algorithms">
<h3><a class="toc-backref" href="#id66"><span class="section-number">16.20.1. </span>Supervised classification algorithms</a><a class="headerlink" href="#supervised-classification-algorithms" title="Permalink to this headline">#</a></h3>
<p><img alt="" src="https://i.imgur.com/vROsEiq.jpg" /></p>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id67"><span class="section-number">16.20.2. </span>Add data to the map</a><a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="o">-</span><span class="mf">122.4439</span><span class="p">,</span> <span class="mf">37.7538</span><span class="p">])</span>
<span class="c1"># point = ee.Geometry.Point([-87.7719, 41.8799])</span>

<span class="n">image</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2016-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-12-31&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;B[1-7]&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]}</span>

<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s2">&quot;Landsat-8&quot;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id68"><span class="section-number">16.20.3. </span>Check image properties</a><a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;system:time_start&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-dd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id69"><span class="section-number">16.20.4. </span>Create training samples</a><a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># region = Map.user_roi</span>
<span class="c1"># region = ee.Geometry.Rectangle([-122.6003, 37.4831, -121.8036, 37.8288])</span>
<span class="c1"># region = ee.Geometry.Point([-122.4439, 37.7538]).buffer(10000)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/7QoRXxu.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/NLCD/NLCD2016&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;landcover&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">nlcd</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the training dataset.</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="o">**</span><span class="p">{</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">geometry</span><span class="p">(),</span>
        <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s1">&#39;numPixels&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;geometries&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Set this to False to ignore geometries</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="train-the-classifier">
<h3><a class="toc-backref" href="#id70"><span class="section-number">16.20.5. </span>Train the classifier</a><a class="headerlink" href="#train-the-classifier" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use these bands for prediction.</span>
<span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">]</span>


<span class="c1"># This property of the table stores the land cover labels.</span>
<span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;landcover&#39;</span>

<span class="c1"># Overlay the points on the imagery to get training.</span>
<span class="n">training</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">sampleRegions</span><span class="p">(</span>
    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="n">points</span><span class="p">,</span> <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Train a CART classifier with default parameters.</span>
<span class="n">trained</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Classifier</span><span class="o">.</span><span class="n">smileCart</span><span class="p">()</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">bands</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">training</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id71"><span class="section-number">16.20.6. </span>Classify the image</a><a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Classify the image with the same bands used for training.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">trained</span><span class="p">)</span>

<span class="c1"># # Display the clusters with random colors.</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">randomVisualizer</span><span class="p">(),</span> <span class="p">{},</span> <span class="s1">&#39;classified&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="render-categorical-map">
<h3><a class="toc-backref" href="#id72"><span class="section-number">16.20.7. </span>Render categorical map</a><a class="headerlink" href="#render-categorical-map" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class_values</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;landcover_class_values&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
<span class="n">class_values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class_palette</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;landcover_class_palette&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
<span class="n">class_palette</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landcover</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;classification_class_values&#39;</span><span class="p">,</span> <span class="n">class_values</span><span class="p">)</span>
<span class="n">landcover</span> <span class="o">=</span> <span class="n">landcover</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;classification_class_palette&#39;</span><span class="p">,</span> <span class="n">class_palette</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Land cover&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3><a class="toc-backref" href="#id73"><span class="section-number">16.20.8. </span>Visualize results</a><a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Change layer opacity:&#39;</span><span class="p">)</span>
<span class="n">cluster_layer</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cluster_layer</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-a-legend-to-the-map">
<h3><a class="toc-backref" href="#id74"><span class="section-number">16.20.9. </span>Add a legend to the map</a><a class="headerlink" href="#add-a-legend-to-the-map" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3><a class="toc-backref" href="#id75"><span class="section-number">16.20.10. </span>Export results</a><a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_export_image</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;landcover.tif&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_export_image_to_drive</span><span class="p">(</span>
    <span class="n">landcover</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;landcover&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">900</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="accuracy-assessment">
<h2><a class="toc-backref" href="#id76"><span class="section-number">16.21. </span>Accuracy assessment</a><a class="headerlink" href="#accuracy-assessment" title="Permalink to this headline">#</a></h2>
<section id="id8">
<h3><a class="toc-backref" href="#id77"><span class="section-number">16.21.1. </span>Supervised classification algorithms</a><a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p><img alt="" src="https://i.imgur.com/vROsEiq.jpg" /></p>
</section>
<section id="id9">
<h3><a class="toc-backref" href="#id78"><span class="section-number">16.21.2. </span>Add data to the map</a><a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h3>
<p><img alt="" src="https://i.imgur.com/7QoRXxu.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">NLCD2016</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/NLCD/NLCD2016&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;landcover&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">NLCD2016</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD 2016&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NLCD_metadata</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/giswqs/landcover/NLCD2016_metadata&quot;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">NLCD_metadata</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD Metadata&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># point = ee.Geometry.Point([-122.4439, 37.7538])  # Sanfrancisco, CA</span>
<span class="c1"># point = ee.Geometry.Point([-83.9293, 36.0526])   # Knoxville, TN</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="o">-</span><span class="mf">88.3070</span><span class="p">,</span> <span class="mf">41.7471</span><span class="p">])</span>  <span class="c1"># Chicago, IL</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="n">NLCD_metadata</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">point</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;2016on_bas&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">doy</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;2016on_bas&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;LC08_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">doy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;YYYYDDD&#39;</span><span class="p">,</span> <span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-dd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;YYYYDDD&#39;</span><span class="p">,</span> <span class="n">doy</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;B[1-7]&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]}</span>

<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s2">&quot;Landsat-8&quot;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_raw</span> <span class="o">=</span> <span class="n">NLCD2016</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">nlcd_raw</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="prepare-for-consecutive-class-labels">
<h3><a class="toc-backref" href="#id79"><span class="section-number">16.21.3. </span>Prepare for consecutive class labels</a><a class="headerlink" href="#prepare-for-consecutive-class-labels" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">raw_class_values</span> <span class="o">=</span> <span class="n">nlcd_raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;landcover_class_values&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_class_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_class_values</span><span class="p">)</span>
<span class="n">new_class_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">))</span>
<span class="n">new_class_values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class_palette</span> <span class="o">=</span> <span class="n">nlcd_raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;landcover_class_palette&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_palette</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd</span> <span class="o">=</span> <span class="n">nlcd_raw</span><span class="o">.</span><span class="n">remap</span><span class="p">(</span><span class="n">raw_class_values</span><span class="p">,</span> <span class="n">new_class_values</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;remapped&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;landcover&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">nlcd</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;landcover_class_values&#39;</span><span class="p">,</span> <span class="n">new_class_values</span><span class="p">)</span>
<span class="n">nlcd</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;landcover_class_palette&#39;</span><span class="p">,</span> <span class="n">class_palette</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">nlcd</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-training-data">
<h3><a class="toc-backref" href="#id80"><span class="section-number">16.21.4. </span>Make training data</a><a class="headerlink" href="#make-training-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the training dataset.</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="o">**</span><span class="p">{</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s1">&#39;numPixels&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;geometries&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Set this to False to ignore geometries</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-training-and-testing">
<h3><a class="toc-backref" href="#id81"><span class="section-number">16.21.5. </span>Split training and testing</a><a class="headerlink" href="#split-training-and-testing" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use these bands for prediction.</span>
<span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">]</span>

<span class="c1"># This property of the table stores the land cover labels.</span>
<span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;landcover&#39;</span>

<span class="c1"># Overlay the points on the imagery to get training.</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">sampleRegions</span><span class="p">(</span>
    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="n">points</span><span class="p">,</span> <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Adds a column of deterministic pseudorandom numbers.</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">randomColumn</span><span class="p">()</span>

<span class="n">split</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="n">training</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">split</span><span class="p">))</span>
<span class="n">validation</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">gte</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">split</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">training</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validation</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3><a class="toc-backref" href="#id82"><span class="section-number">16.21.6. </span>Train the classifier</a><a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Classifier</span><span class="o">.</span><span class="n">smileRandomForest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">bands</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h3><a class="toc-backref" href="#id83"><span class="section-number">16.21.7. </span>Classify the image</a><a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Classify the image with the same bands used for training.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>

<span class="c1"># # Display the clusters with random colors.</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">randomVisualizer</span><span class="p">(),</span> <span class="p">{},</span> <span class="s1">&#39;classfied&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h3><a class="toc-backref" href="#id84"><span class="section-number">16.21.8. </span>Render categorical map</a><a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class_values</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;landcover_class_values&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class_palette</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;landcover_class_palette&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_palette</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landcover</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;classification_class_values&#39;</span><span class="p">,</span> <span class="n">class_values</span><span class="p">)</span>
<span class="n">landcover</span> <span class="o">=</span> <span class="n">landcover</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;classification_class_palette&#39;</span><span class="p">,</span> <span class="n">class_palette</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Land cover&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3><a class="toc-backref" href="#id85"><span class="section-number">16.21.9. </span>Visualize results</a><a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Change layer opacity:&#39;</span><span class="p">)</span>
<span class="n">cluster_layer</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cluster_layer</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3><a class="toc-backref" href="#id86"><span class="section-number">16.21.10. </span>Add a legend to the map</a><a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s1">&#39;NLCD&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h3><a class="toc-backref" href="#id87"><span class="section-number">16.21.11. </span>Accuracy assessment</a><a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h3>
<section id="training-dataset">
<h4><span class="section-number">16.21.11.1. </span>Training dataset<a class="headerlink" href="#training-dataset" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_accuracy</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">confusionMatrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_accuracy</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_accuracy</span><span class="o">.</span><span class="n">accuracy</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_accuracy</span><span class="o">.</span><span class="n">kappa</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_accuracy</span><span class="o">.</span><span class="n">producersAccuracy</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_accuracy</span><span class="o">.</span><span class="n">consumersAccuracy</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="validation-dataset">
<h5><span class="section-number">16.21.11.1.1. </span>Validation dataset<a class="headerlink" href="#validation-dataset" title="Permalink to this headline">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validated</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validated</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">validated</span><span class="o">.</span><span class="n">errorMatrix</span><span class="p">(</span><span class="s1">&#39;landcover&#39;</span><span class="p">,</span> <span class="s1">&#39;classification&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_accuracy</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_accuracy</span><span class="o">.</span><span class="n">accuracy</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_accuracy</span><span class="o">.</span><span class="n">kappa</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_accuracy</span><span class="o">.</span><span class="n">producersAccuracy</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_accuracy</span><span class="o">.</span><span class="n">consumersAccuracy</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="download-confusion-matrix">
<h3><a class="toc-backref" href="#id88"><span class="section-number">16.21.12. </span>Download confusion matrix</a><a class="headerlink" href="#download-confusion-matrix" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">training_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s1">&#39;train_accuracy.csv&#39;</span><span class="p">)</span>
<span class="n">testing_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s1">&#39;test_accuracy.csv&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">training_csv</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">train_accuracy</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">testing_csv</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">test_accuracy</span><span class="o">.</span><span class="n">getInfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reclassify-land-cover-map">
<h3><a class="toc-backref" href="#id89"><span class="section-number">16.21.13. </span>Reclassify land cover map</a><a class="headerlink" href="#reclassify-land-cover-map" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landcover</span> <span class="o">=</span> <span class="n">landcover</span><span class="o">.</span><span class="n">remap</span><span class="p">(</span><span class="n">new_class_values</span><span class="p">,</span> <span class="n">raw_class_values</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;remapped&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">landcover</span> <span class="o">=</span> <span class="n">landcover</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;classification_class_values&#39;</span><span class="p">,</span> <span class="n">raw_class_values</span><span class="p">)</span>
<span class="n">landcover</span> <span class="o">=</span> <span class="n">landcover</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;classification_class_palette&#39;</span><span class="p">,</span> <span class="n">class_palette</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;Final land cover&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3><a class="toc-backref" href="#id90"><span class="section-number">16.21.14. </span>Export results</a><a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">out_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s1">&#39;landcover.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_export_image</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">out_file</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">ee_export_image_to_drive</span><span class="p">(</span>
    <span class="n">landcover</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;landcover&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;export&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">900</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="using-locally-trained-machine-learning-models">
<h2><a class="toc-backref" href="#id91"><span class="section-number">16.22. </span>Using locally trained machine learning models</a><a class="headerlink" href="#using-locally-trained-machine-learning-models" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">geemap</span> <span class="kn">import</span> <span class="n">ml</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">ensemble</span>
</pre></div>
</div>
</div>
</div>
<section id="train-a-model-locally-using-scikit-learn">
<h3><a class="toc-backref" href="#id92"><span class="section-number">16.22.1. </span>Train a model locally using scikit-learn</a><a class="headerlink" href="#train-a-model-locally-using-scikit-learn" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the feature table to train our RandomForest model</span>
<span class="c1"># data taken from ee.FeatureCollection(&#39;GOOGLE/EE/DEMOS/demo_landcover_labels&#39;)</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/giswqs/geemap/master/examples/data/rf_example.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># specify the names of the features (i.e. band names) and label</span>
<span class="c1"># feature names used to extract out features and define what bands</span>

<span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">]</span>
<span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;landcover&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the features and labels into separate variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a classifier and fit</span>
<span class="n">n_trees</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_trees</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="convert-a-sklearn-classifier-object-to-a-list-of-strings">
<h3><a class="toc-backref" href="#id93"><span class="section-number">16.22.2. </span>Convert a sklearn classifier object to a list of strings</a><a class="headerlink" href="#convert-a-sklearn-classifier-object-to-a-list-of-strings" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert the estimator into a list of strings</span>
<span class="c1"># this function also works with the ensemble.ExtraTrees estimator</span>
<span class="n">trees</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">rf_to_strings</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">)</span>
<span class="c1"># print the first tree to see the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trees</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">trees</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of trees we converted should equal the number of trees we defined for the model</span>
<span class="nb">len</span><span class="p">(</span><span class="n">trees</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_trees</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="convert-sklearn-classifier-to-gee-classifier">
<h3><a class="toc-backref" href="#id94"><span class="section-number">16.22.3. </span>Convert sklearn classifier to GEE classifier</a><a class="headerlink" href="#convert-sklearn-classifier-to-gee-classifier" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a ee classifier to use with ee objects from the trees</span>
<span class="n">ee_classifier</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">strings_to_classifier</span><span class="p">(</span><span class="n">trees</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ee_classifier.getInfo()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="classify-image-using-gee-classifier">
<h3><a class="toc-backref" href="#id95"><span class="section-number">16.22.4. </span>Classify image using GEE classifier</a><a class="headerlink" href="#classify-image-using-gee-classifier" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a cloud-free Landsat 8 TOA composite (from raw imagery).</span>
<span class="n">l8</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1&#39;</span><span class="p">)</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">Landsat</span><span class="o">.</span><span class="n">simpleComposite</span><span class="p">(</span>
    <span class="n">collection</span><span class="o">=</span><span class="n">l8</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-31&#39;</span><span class="p">),</span> <span class="n">asFloat</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># classify the image using the classifier we created from the local training</span>
<span class="c1"># note: here we select the feature_names from the image that way the classifier knows which bands to use</span>
<span class="n">classified</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">ee_classifier</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># display results</span>
<span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mf">37.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.25</span><span class="p">),</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
    <span class="s1">&#39;image&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">classified</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;classification&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="save-trees-to-the-cloud">
<h3><a class="toc-backref" href="#id96"><span class="section-number">16.22.5. </span>Save trees to the cloud</a><a class="headerlink" href="#save-trees-to-the-cloud" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_id</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">ee_user_id</span><span class="p">()</span>
<span class="n">user_id</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># specify asset id where to save trees</span>
<span class="c1"># be sure to change &lt;user_name&gt; to your ee user name</span>
<span class="n">asset_id</span> <span class="o">=</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/random_forest_strings_test&quot;</span>
<span class="n">asset_id</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># kick off an export process so it will be saved to the ee asset</span>
<span class="n">ml</span><span class="o">.</span><span class="n">export_trees_to_fc</span><span class="p">(</span><span class="n">trees</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">)</span>

<span class="c1"># this will kick off an export task, so wait a few minutes before moving on</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the exported tree feature collection</span>
<span class="n">rf_fc</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">asset_id</span><span class="p">)</span>

<span class="c1"># convert it to a classifier, very similar to the `ml.trees_to_classifier` function</span>
<span class="n">another_classifier</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">fc_to_classifier</span><span class="p">(</span><span class="n">rf_fc</span><span class="p">)</span>

<span class="c1"># classify the image again but with the classifier from the persisted trees</span>
<span class="n">classified</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">another_classifier</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># display results</span>
<span class="c1"># we should get the exact same results as before</span>
<span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mf">37.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.25</span><span class="p">),</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
    <span class="s1">&#39;image&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">classified</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;classification&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="save-trees-locally">
<h3><a class="toc-backref" href="#id97"><span class="section-number">16.22.6. </span>Save trees locally</a><a class="headerlink" href="#save-trees-locally" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">out_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;trees.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ml</span><span class="o">.</span><span class="n">trees_to_csv</span><span class="p">(</span><span class="n">trees</span><span class="p">,</span> <span class="n">out_csv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">another_classifier</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">csv_to_classifier</span><span class="p">(</span><span class="n">out_csv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">classified</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">another_classifier</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># display results</span>
<span class="c1"># we should get the exact same results as before</span>
<span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mf">37.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.25</span><span class="p">),</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
    <span class="s1">&#39;image&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span>
    <span class="n">classified</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;classification&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="global-land-cover-area">
<h2><a class="toc-backref" href="#id98"><span class="section-number">16.23. </span>Global land cover area</a><a class="headerlink" href="#global-land-cover-area" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;ESA/WorldCover/v100&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Map&#39;</span><span class="p">]},</span> <span class="s1">&#39;ESA Land Cover&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s1">&#39;ESA_WorldCover&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_area_by_group</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">denominator</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;esa_area.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s1">&#39;HYBRID&#39;</span><span class="p">)</span>

<span class="n">nlcd</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;USGS/NLCD_RELEASES/2019_REL/NLCD/2019&#39;</span><span class="p">)</span>
<span class="n">landcover</span> <span class="o">=</span> <span class="n">nlcd</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;landcover&#39;</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">landcover</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;NLCD Land Cover 2019&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;NLCD Land Cover Classification&quot;</span><span class="p">,</span> <span class="n">builtin_legend</span><span class="o">=</span><span class="s1">&#39;NLCD&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;465px&#39;</span>
<span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">image_area_by_group</span><span class="p">(</span>
    <span class="n">landcover</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">denominator</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;nlcd_area.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="whiteboxtools">
<h2><a class="toc-backref" href="#id99"><span class="section-number">16.24. </span>WhiteboxTools</a><a class="headerlink" href="#whiteboxtools" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">geemap</span><span class="p">[</span><span class="n">lidar</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="import-libraries">
<h3><a class="toc-backref" href="#id100"><span class="section-number">16.24.1. </span>Import libraries</a><a class="headerlink" href="#import-libraries" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">geemap</span>
<span class="kn">import</span> <span class="nn">whitebox</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-whitebox">
<h3><a class="toc-backref" href="#id101"><span class="section-number">16.24.2. </span>Set up whitebox</a><a class="headerlink" href="#set-up-whitebox" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wbt</span> <span class="o">=</span> <span class="n">whitebox</span><span class="o">.</span><span class="n">WhiteboxTools</span><span class="p">()</span>
<span class="n">wbt</span><span class="o">.</span><span class="n">set_working_dir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">wbt</span><span class="o">.</span><span class="n">set_verbose_mode</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-sample-data">
<h3><a class="toc-backref" href="#id102"><span class="section-number">16.24.3. </span>Download sample data</a><a class="headerlink" href="#download-sample-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/giswqs/data/raw/main/lidar/madison.laz&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;madison.laz&#39;</span><span class="p">):</span>
    <span class="n">geemap</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-las-laz-data">
<h3><a class="toc-backref" href="#id103"><span class="section-number">16.24.4. </span>Read LAS/LAZ data</a><a class="headerlink" href="#read-las-laz-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">laz</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">read_lidar</span><span class="p">(</span><span class="s1">&#39;madison.laz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">laz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">laz</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="upgrade-file-version">
<h3><a class="toc-backref" href="#id104"><span class="section-number">16.24.5. </span>Upgrade file version</a><a class="headerlink" href="#upgrade-file-version" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">las</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">convert_lidar</span><span class="p">(</span><span class="n">laz</span><span class="p">,</span> <span class="n">file_version</span><span class="o">=</span><span class="s1">&#39;1.4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">las</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="write-las-data">
<h3><a class="toc-backref" href="#id105"><span class="section-number">16.24.6. </span>Write LAS data</a><a class="headerlink" href="#write-las-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">write_lidar</span><span class="p">(</span><span class="n">las</span><span class="p">,</span> <span class="s1">&#39;madison.las&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="histogram-analysis">
<h3><a class="toc-backref" href="#id106"><span class="section-number">16.24.7. </span>Histogram analysis</a><a class="headerlink" href="#histogram-analysis" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wbt</span><span class="o">.</span><span class="n">lidar_histogram</span><span class="p">(</span><span class="s1">&#39;madison.las&#39;</span><span class="p">,</span> <span class="s1">&#39;histogram.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-lidar-data">
<h3><a class="toc-backref" href="#id107"><span class="section-number">16.24.8. </span>Visualize LiDAR data</a><a class="headerlink" href="#visualize-lidar-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">view_lidar</span><span class="p">(</span><span class="s1">&#39;madison.las&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="remove-outliers">
<h3><a class="toc-backref" href="#id108"><span class="section-number">16.24.9. </span>Remove outliers</a><a class="headerlink" href="#remove-outliers" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wbt</span><span class="o">.</span><span class="n">lidar_elevation_slice</span><span class="p">(</span><span class="s2">&quot;madison.las&quot;</span><span class="p">,</span> <span class="s2">&quot;madison_rm.las&quot;</span><span class="p">,</span> <span class="n">minz</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxz</span><span class="o">=</span><span class="mi">450</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-lidar-data-after-removing-outliers">
<h3><a class="toc-backref" href="#id109"><span class="section-number">16.24.10. </span>Visualize LiDAR data after removing outliers</a><a class="headerlink" href="#visualize-lidar-data-after-removing-outliers" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">view_lidar</span><span class="p">(</span><span class="s1">&#39;madison_rm.las&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-dsm">
<h3><a class="toc-backref" href="#id110"><span class="section-number">16.24.11. </span>Create DSM</a><a class="headerlink" href="#create-dsm" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wbt</span><span class="o">.</span><span class="n">lidar_digital_surface_model</span><span class="p">(</span>
    <span class="s1">&#39;madison_rm.las&#39;</span><span class="p">,</span> <span class="s1">&#39;dsm.tif&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">minz</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxz</span><span class="o">=</span><span class="mi">450</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geemap</span><span class="o">.</span><span class="n">add_crs</span><span class="p">(</span><span class="s2">&quot;dsm.tif&quot;</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">2255</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-dsm">
<h3><a class="toc-backref" href="#id111"><span class="section-number">16.24.12. </span>Visualize DSM</a><a class="headerlink" href="#visualize-dsm" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span><span class="s1">&#39;dsm.tif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;DSM&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-dem">
<h3><a class="toc-backref" href="#id112"><span class="section-number">16.24.13. </span>Create DEM</a><a class="headerlink" href="#create-dem" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wbt</span><span class="o">.</span><span class="n">remove_off_terrain_objects</span><span class="p">(</span><span class="s1">&#39;dsm.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;dem.tif&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="mf">15.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-dem">
<h3><a class="toc-backref" href="#id113"><span class="section-number">16.24.14. </span>Visualize DEM</a><a class="headerlink" href="#visualize-dem" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span><span class="s1">&#39;dem.tif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;DEM&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-chm">
<h3><a class="toc-backref" href="#id114"><span class="section-number">16.24.15. </span>Create CHM</a><a class="headerlink" href="#create-chm" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chm</span> <span class="o">=</span> <span class="n">wbt</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="s1">&#39;dsm.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;dem.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;chm.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span><span class="s1">&#39;chm.tif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;gist_earth&#39;</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;CHM&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id115"><span class="section-number">16.25. </span>Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id116"><span class="section-number">16.26. </span>References</a><a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://geemap.org/notebooks/12_zonal_statistics/">https://geemap.org/notebooks/12_zonal_statistics/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/13_zonal_statistics_by_group/">https://geemap.org/notebooks/13_zonal_statistics_by_group/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/31_unsupervised_classification/">https://geemap.org/notebooks/31_unsupervised_classification/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/32_supervised_classification/">https://geemap.org/notebooks/32_supervised_classification/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/33_accuracy_assessment/">https://geemap.org/notebooks/33_accuracy_assessment/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/34_extract_values/">https://geemap.org/notebooks/34_extract_values/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/36_quality_mosaic/">https://geemap.org/notebooks/36_quality_mosaic/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/46_local_rf_training/">https://geemap.org/notebooks/46_local_rf_training/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/59_whitebox/">https://geemap.org/notebooks/59_whitebox/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/63_charts/">https://geemap.org/notebooks/63_charts/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/67_training_samples/">https://geemap.org/notebooks/67_training_samples/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/71_timelapse/">https://geemap.org/notebooks/71_timelapse/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/108_image_zonal_stats/">https://geemap.org/notebooks/108_image_zonal_stats/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/109_coordinate_grids/">https://geemap.org/notebooks/109_coordinate_grids/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/111_image_count/">https://geemap.org/notebooks/111_image_count/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/113_image_area/">https://geemap.org/notebooks/113_image_area/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/114_dynamic_world/">https://geemap.org/notebooks/114_dynamic_world/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/115_land_cover/">https://geemap.org/notebooks/115_land_cover/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/116_land_cover_timeseries/">https://geemap.org/notebooks/116_land_cover_timeseries/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/117_fishnet/">https://geemap.org/notebooks/117_fishnet/</a></p></li>
<li><p><a class="reference external" href="https://geemap.org/notebooks/122_lidar/">https://geemap.org/notebooks/122_lidar/</a></p></li>
<li><p><a class="reference external" href="https://developers.google.com/earth-engine/tutorials/tutorial_api_06">https://developers.google.com/earth-engine/tutorials/tutorial_api_06</a></p></li>
<li><p><a class="reference external" href="https://developers.google.com/earth-engine/guides/clustering">https://developers.google.com/earth-engine/guides/clustering</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/gee"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="05_data_viz.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">15. </span>Visualizing Geospatial Data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="07_data_export.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">17. </span>Exporting Earth Engine Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Qiusheng Wu<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>